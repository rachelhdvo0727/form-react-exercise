{"version":3,"sources":["modules/vars.js","script.js"],"names":["endpoint","apiKey","form","document","querySelector","pattern","content","elms","elements","formElms","querySelectorAll","window","addEventListener","start","evt","classList","remove","add","setAttribute","checkInfo","autoFillInfo","get","preventDefault","forEach","elm","validForm","checkValidity","dataset","state","post","first_name","fstname","value","last_name","lstname","age","email","put","id","reset","unknownDOB","dob","disabled","e","ageStr","ageNum","parseInt","currentYr","innerHTML","fetch","method","headers","accept","then","json","showData","showFriends","friend","display","clone","cloneNode","textContent","_id","deleteAFriend","getAFriend","setupFormforEdit","appendChild","data","postData","JSON","stringify","body","res","callback","console","log","putData","copy"],"mappings":"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","file":"script.75da7f30.js","sourceRoot":"..","sourcesContent":["export const endpoint = \"https://frontendspring20-e4cd.restdb.io/rest/friends\";\nexport const apiKey = \"5e956ffd436377171a0c230f\";\nexport const form = document.querySelector(\"form\");\nexport const pattern = document.querySelector(\"template\").content;\nexport const elms = form.elements;\nexport const formElms = form.querySelectorAll(\"input\"); \n","\"use strict\";\nwindow.addEventListener(\"DOMContentLoaded\", start);\nimport {\n  endpoint,\n  apiKey,\n  form,\n  pattern,\n  elms,\n  formElms,\n} from \"./modules/vars\";\n\nfunction start() {\n  document.querySelector(\".add\").addEventListener(\"click\", (evt) => {\n    form.classList.remove(\"hidden\");\n    document.querySelector(\"main\").classList.add(\"blurBg\");\n  });\n  document.querySelector(\".cancel\").addEventListener(\"click\", () => {\n    form.classList.add(\"hidden\");\n    document.querySelector(\"main\").classList.remove(\"blurBg\");\n  });\n  form.setAttribute(\"novalidate\", true);\n  checkInfo();\n  autoFillInfo();\n  get();\n}\nfunction checkInfo() {\n  form.addEventListener(\"submit\", (evt) => {\n    evt.preventDefault(); //turn off validation on submit\n    formElms.forEach((elm) => {\n      elm.classList.remove(\"invalid\");\n    });\n    let validForm = true;\n    if (form.checkValidity() && validForm) {\n      if (form.dataset.state === \"post\") {\n        post({\n          first_name: elms.fstname.value,\n          last_name: elms.lstname.value,\n          age: elms.age.value,\n          email: elms.email.value\n        });\n      } else {\n        put({\n          first_name: elms.fstname.value,\n          last_name: elms.lstname.value,\n          age: elms.age.value,\n          email: elms.email.value\n        }, form.dataset.id);\n      }\n      form.classList.add(\"hidden\");\n      form.reset();\n    } else {\n      //loop validity\n      formElms.forEach((elm) => {\n        elm.classList.remove(\"invalid\");\n        if (!elm.checkValidity()) {\n          elm.classList.add(\"invalid\");\n        }\n      });\n    }\n  });\n}\nfunction autoFillInfo() {\n  elms.unknownDOB.addEventListener(\"click\", (evt) => {\n    elms.dob.disabled = !elms.dob.disabled;\n    elms.age.disabled = !elms.age.disabled;\n  });\n  elms.dob.addEventListener(\"change\", (e) => {\n    let ageStr = elms.dob.value;\n    let ageNum = parseInt(ageStr);\n    let currentYr = 2020;\n    elms.age.value = currentYr - ageNum;\n  });\n}\nfunction get() {\n  document.querySelector(\"main\").innerHTML = \"\";\n  fetch(endpoint, {\n    method: \"get\",\n    headers: {\n      accept: \"application/json\",\n      \"x-apikey\": apiKey,\n      \"cache-control\": \"no-cache\",\n    },\n  })\n    .then((e) => e.json())\n    .then(showData);\n}\n\nfunction showData(e) {\n  e.forEach(showFriends);\n}\n\nfunction showFriends(friend) {\n  const display = document.querySelector(\"main\");\n  const clone = pattern.cloneNode(true);\n  clone.querySelector(\".first\").textContent = friend.first_name;\n  clone.querySelector(\".last\").textContent = friend.last_name;\n  clone.querySelector(\".email\").textContent = friend.email;\n  clone.querySelector(\".age\").textContent = friend.age;\n  //clone.querySelector(\"button\").dataset.id = friend._id;\n  clone\n    .querySelectorAll(`article, button[data-action=\"delete\"]`)\n    .forEach((elm) => (elm.dataset.id = friend._id));\n  clone\n    .querySelector(`[data-action=\"delete\"]`)\n    .addEventListener(\"click\", (elm) => deleteAFriend(friend._id));\n  clone\n    .querySelector(`[data-action=\"edit\"]`)\n    .addEventListener(\"click\", (elm) => getAFriend(friend._id, setupFormforEdit));\n  display.appendChild(clone);\n}\nfunction post(data) {\n  const postData = JSON.stringify(data);\n  fetch(endpoint, {\n    method: \"post\",\n    headers: {\n      \"Content-Type\": \"application/json; charset=utf-8\",\n      \"x-apikey\": apiKey,\n      \"cache-control\": \"no-cache\",\n    },\n    body: postData,\n  })\n    .then((res) => res.json())\n    .then((data) => showFriends(data));\n}\n\nfunction deleteAFriend(id) {\n  document.querySelector(`article[data-id=\"${id}\"]`).remove();\n  fetch(`${endpoint}/${id}`, {\n    method: \"delete\",\n    headers: {\n      \"Content-Type\": \"application/json; charset=utf-8\",\n      \"x-apikey\": apiKey,\n      \"cache-control\": \"no-cache\",\n    },\n  })\n    .then((res) => res.json())\n    .then((data) => { });\n}\nfunction getAFriend(id, callback) {\n  //fetch data, using the id\n  fetch(`${endpoint}/${id}`, {\n    method: \"get\",\n    headers: {\n      accept: \"application/json\",\n      \"x-apikey\": apiKey,\n      \"cache-control\": \"no-cache\",\n    },\n  })\n    .then((e) => e.json())\n    .then((data) => callback(data));\n}\nfunction setupFormforEdit(data) {\n  console.log(\"on\");\n  //show the form\n  form.classList.remove(\"hidden\");\n  document.querySelector(\"main\").classList.add(\"blurBg\");\n  //populate the form\n  form.dataset.state = \"put\";\n  form.dataset.id = data._id;\n  elms.fstname.value = data.first_name;\n  elms.lstname.value = data.last_name;\n  //handle submits\n  document.querySelector(\".submit\").addEventListener(\"click\", (e) => {\n    checkInfo();\n    form.classList.add(\"hidden\");\n    document.querySelector(\"main\").classList.remove(\"blurBg\");\n  })\n  //remove evt handler and add evt handler\n}\nfunction put(data, id) {\n  const putData = JSON.stringify(data);\n  fetch(`${endpoint}/${id}`, {\n    method: \"put\",\n    headers: {\n      \"Content-Type\": \"application/json; charset=utf-8\",\n      \"x-apikey\": apiKey,\n      \"cache-control\": \"no-cache\",\n    },\n    body: putData,\n  })\n    .then((res) => res.json())\n    .then((data) => {\n      const copy = document.querySelector(`article[data-id='${id}']`);\n      copy.querySelector(\".first\").textContent = data.first_name;\n      copy.querySelector(\".last\").textContent = data.last_name;\n      copy.querySelector(\".email\").textContent = data.email;\n      copy.querySelector(\".age\").textContent = data.age;\n      //clone.querySelector(\"button\").dataset.id = friend._id;\n      copy\n        .querySelector(`[data-action=\"delete\"]`)\n        .addEventListener(\"click\", (elm) => deleteAFriend(data._id));\n      copy\n        .querySelector(`[data-action=\"edit\"]`)\n        .addEventListener(\"click\", (elm) => getAFriend(data._id, setupFormforEdit));\n    });\n}"]}